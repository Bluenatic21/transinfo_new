diff --git a/frontend/src/app/components/MessengerContext.js b/frontend/src/app/components/MessengerContext.js
index 7e9e33263c938a84f35510548f4e1af672434002..7f0c41a4a1d9162d62fde37c2f37e1705c6f4a57 100644
--- a/frontend/src/app/components/MessengerContext.js
+++ b/frontend/src/app/components/MessengerContext.js
@@ -1065,80 +1065,116 @@ export function MessengerProvider({ children }) {
             return prev.map((m, i) =>
               i === lastIdx ? { ...m, is_read: true } : m
             );
           });
           setAllMessages((prev) => {
             const arr = prev[data.chat_id] || [];
             let lastIdx = -1;
             for (let i = arr.length - 1; i >= 0; --i) {
               if (arr[i].sender_id === getCurrentUser()?.id) {
                 lastIdx = i;
                 break;
               }
             }
             if (lastIdx === -1) return prev;
             return {
               ...prev,
               [data.chat_id]: arr.map((m, i) =>
                 i === lastIdx ? { ...m, is_read: true } : m
               ),
             };
           });
           return;
         }
 
         // реакции
-        if (
-          data?.event === "reaction_update" &&
-          data.message_id &&
-          Array.isArray(data.reactions)
-        ) {
+        if (
+          data?.event === "reaction_update" &&
+          data.message_id &&
+          Array.isArray(data.reactions)
+        ) {
           setMessages((prev) =>
             prev.map((msg) =>
               msg.id === data.message_id
                 ? { ...msg, reactions: data.reactions }
                 : msg
             )
           );
           setAllMessages((prev) => {
             const arr = prev[data.chat_id] || [];
             return {
               ...prev,
               [data.chat_id]: arr.map((msg) =>
                 msg.id === data.message_id
                   ? { ...msg, reactions: data.reactions }
                   : msg
               ),
             };
           });
-          return;
-        }
-
-        // Эфемерные action-события
-        try {
-          const action = data?.action;
-          const cid = data?.chat_id || data?.data?.chat_id;
+          return;
+        }
+
+        if (data?.event === "message.updated" && data?.message) {
+          const incoming = data.message;
+          const target = data.chat_id || incoming.chat_id;
+
+          setMessages((prev) => {
+            if (chatIdRef.current !== target) return prev;
+            return prev.map((msg) =>
+              msg.id === incoming.id ||
+                (msg.client_id && incoming.client_id &&
+                  msg.client_id === incoming.client_id)
+                ? { ...msg, ...incoming, edited: true }
+                : msg
+            );
+          });
+
+          setAllMessages((prev) => {
+            if (!target) return prev;
+            const arr = prev[target] || [];
+            const idx = arr.findIndex(
+              (m) =>
+                m.id === incoming.id ||
+                (m.client_id && incoming.client_id &&
+                  m.client_id === incoming.client_id)
+            );
+            const next = arr.slice();
+            if (idx === -1) next.push({ ...incoming, edited: true });
+            else next[idx] = { ...next[idx], ...incoming, edited: true };
+            return { ...prev, [target]: next };
+          });
+
+          try {
+            ensureChatInSidebar(target, { lastMessage: incoming });
+          } catch {}
+          return;
+        }
+
+        // Эфемерные action-события
+        try {
+          const action = data?.action;
+          const cid = data?.chat_id || data?.data?.chat_id;
 
           if (action === "message.new" && data?.data) {
             const inc = data.data;
             const target = cid || inc.chat_id;
 
             if (chatIdRef.current === target) {
               setMessages((prev) => {
                 if (prev.some((m) => m.id === inc.id)) return prev;
                 const i = prev.findIndex(
                   (m) =>
                     m.client_id &&
                     inc.client_id &&
                     m.client_id === inc.client_id
                 );
                 const next = prev.slice();
                 if (i !== -1) next[i] = inc;
                 else next.push(inc);
                 return next.slice().sort(_cmpMsgAsc);
               });
               setAllMessages((prev) => {
                 const arr = prev[target] || [];
                 if (arr.some((m) => m.id === inc.id)) return prev;
                 const j = arr.findIndex(
                   (m) =>
                     m.client_id &&
@@ -1596,56 +1632,101 @@ export function MessengerProvider({ children }) {
         });
         // сразу дописываем превью последнего сообщения и корректного peer в карточку
         try {
           ensureChatInSidebar(chatId, { peer: peerUser, lastMessage: data });
         } catch {}
 
         fetchChatList();
         window.dispatchEvent(new CustomEvent("inbox_update"));
       } else {
         // пометим как неотправленное
         setMessages((prev) =>
           prev.map((m) =>
             m.client_id === client_id ? { ...m, _failed: true } : m
           )
         );
         setAllMessages((prev) => {
           const arr = prev[chatId] || [];
           return {
             ...prev,
             [chatId]: arr.map((m) =>
               m.client_id === client_id ? { ...m, _failed: true } : m
             ),
           };
         });
       }
-    },
-    [chatId, authFetchWithRefresh, fetchChatList, ensureChatInSidebar, peerUser]
-  );
-  // --- ПУБЛИЧНЫЙ API: отправка карточки звонка (в конкретный чат) ---
-  const sendCallMessage = useCallback(
-    async (data = {}, targetChatId = null) => {
+    },
+    [chatId, authFetchWithRefresh, fetchChatList, ensureChatInSidebar, peerUser]
+  );
+
+  const editMessage = useCallback(
+    async (messageId, content) => {
+      if (!chatId || !messageId) return null;
+      const payload = { content };
+      const res = await authFetchWithRefresh(
+        api(`/chat/${chatId}/messages/${messageId}`),
+        {
+          method: "PUT",
+          headers: { "Content-Type": "application/json" },
+          body: JSON.stringify(payload),
+        }
+      );
+
+      if (!res.ok) throw new Error("edit_failed");
+
+      const data = await res.json();
+      const patched = {
+        ...data,
+        edited: true,
+        edited_at: data.edited_at || new Date().toISOString(),
+      };
+
+      setMessages((prev) => {
+        if (chatIdRef.current !== chatId) return prev;
+        return prev.map((m) => (m.id === patched.id ? { ...m, ...patched } : m));
+      });
+
+      setAllMessages((prev) => {
+        const arr = prev[chatId] || [];
+        const idx = arr.findIndex((m) => m.id === patched.id);
+        const next = arr.slice();
+        if (idx === -1) next.push(patched);
+        else next[idx] = { ...next[idx], ...patched };
+        return { ...prev, [chatId]: next };
+      });
+
+      try {
+        ensureChatInSidebar(chatId, { peer: peerUser, lastMessage: patched });
+      } catch {}
+
+      return patched;
+    },
+    [authFetchWithRefresh, chatId, ensureChatInSidebar, peerUser]
+  );
+  // --- ПУБЛИЧНЫЙ API: отправка карточки звонка (в конкретный чат) ---
+  const sendCallMessage = useCallback(
+    async (data = {}, targetChatId = null) => {
       const id = targetChatId || chatIdRef.current || chatId;
       if (!id) return;
 
       // нормализуем полезную нагрузку карточки
       const safe = {
         status: data.status || data.state || "ended", // ended|missed|rejected|canceled
         direction: data.direction || "outgoing", // incoming|outgoing
         duration:
           (typeof data.duration === "number" ? data.duration : data.seconds) ||
           null,
       };
       const payload = JSON.stringify(safe);
 
       // --- оптимистичное добавление в нужный чат ---
       const client_id = `c${Date.now()}-${Math.random()
         .toString(36)
         .slice(2, 8)}`;
       const me = getCurrentUser && getCurrentUser();
       const _client_ts = Date.now();
       const _client_seq = (optimisticSeqRef.current =
         optimisticSeqRef.current + 1);
       const optimistic = {
         id: `tmp:${client_id}`,
         client_id,
         sender_id: me?.id,
@@ -1845,60 +1926,61 @@ export function MessengerProvider({ children }) {
         try {
           wsRef.current.close();
         } catch {}
         wsRef.current = null;
       }
       setMessages([]);
       setPeerUser(null);
       setPendingAttachment(null);
     }
   }, []);
 
   // --- selectors for ephemeral state ---
   const getSupportTyping = useCallback((id) => {
     return !!supportTypingRef.current.get(id);
   }, []);
   const getSupportQueue = useCallback((id) => {
     return supportQueueRef.current.get(id) || null;
   }, []);
 
   return (
     <MessengerContext.Provider
       value={{
         isOpen,
         openMessenger,
         closeMessenger,
-        hideMessengerUi,
-        markChatRead,
-        messages,
-        setMessages,
-        sendMessage,
-        sendCallMessage,
-        chatId,
-        setChatId,
-        peerUser,
-        setPeerUser,
+        hideMessengerUi,
+        markChatRead,
+        messages,
+        setMessages,
+        sendMessage,
+        editMessage,
+        sendCallMessage,
+        chatId,
+        setChatId,
+        peerUser,
+        setPeerUser,
         unread,
         fetchUnreadCount,
         chatList,
         fetchChatList, // reload first page
         fetchMoreChats, // load next page (append)
         chatListEOF,
         chatListLoading,
         currentUser,
         connectWS,
         pendingAttachment,
         setPendingAttachment,
         allMessages,
         setAllMessages,
         notificationsSocket,
         fetchMessages: fetchMessagesById,
         fetchOlderMessages: fetchOlderMessagesById,
         mutedGroups,
         muteGroup,
         unmuteGroup,
         pinnedChats,
         pinChat,
         unpinChat,
         // helpers
         isSupportChat,
         getChatById,
